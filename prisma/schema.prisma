// npx prisma migrate dev --name init 

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Config {
  id ConfigType @id

  categorizer_system_message String
  categorizer_temperature    Float
}

model Profile {
  id              String    @id @default(uuid())
  created_at      DateTime  @default(now())
  fb_messenger_id String    @unique
  country         String?
  messages        Message[]

  @@index(fields: [fb_messenger_id], type: Hash)
}

model Message {
  id              String    @id @default(uuid())
  created_at     DateTime    @default(now())
  content        String?
  tool_call_id   String?
  tool_call_name String?
  profile        Profile     @relation(fields: [profile_id], references: [id])
  profile_id     String
  message_dir    MessageDir
  role           MessageRole

  @@index(fields: [created_at], type: BTree)
}

enum MessageRole {
  USER
  ASSISTANT
  TOOL
}

enum MessageDir {
  INBOUND
  OUTBOUND
}

enum ConfigType {
  FREE
  TIER_ONE
}
